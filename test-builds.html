<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Build Test - rembg-web</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }
      .test-section {
        margin: 20px 0;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
      }
      .success {
        background: #d4edda;
        border-color: #c3e6cb;
      }
      .error {
        background: #f8d7da;
        border-color: #f5c6cb;
      }
      .info {
        background: #d1ecf1;
        border-color: #bee5eb;
      }
      pre {
        background: #f8f9fa;
        padding: 10px;
        border-radius: 3px;
        overflow-x: auto;
      }
    </style>
    <!-- Test UMD build -->
    <script src="https://unpkg.com/onnxruntime-web@latest/dist/ort.min.js"></script>
    <script src="./dist/index.umd.js"></script>
  </head>
  <body>
    <h1>rembg-web Build Test</h1>
    <p>Testing both ES Module and UMD builds</p>

    <div id="results"></div>

    <script>
      const results = document.getElementById('results');

      function addResult(title, success, message) {
        const div = document.createElement('div');
        div.className = `test-section ${success ? 'success' : 'error'}`;
        div.innerHTML = `
                <h3>${title}</h3>
                <p>${message}</p>
            `;
        results.appendChild(div);
      }

      // Test 1: Check if RembgWeb global exists
      if (typeof RembgWeb !== 'undefined') {
        addResult(
          '‚úÖ UMD Global Variable',
          true,
          `RembgWeb global object found with ${Object.keys(RembgWeb).length} exports: ${Object.keys(RembgWeb).slice(0, 5).join(', ')}...`
        );
      } else {
        addResult(
          '‚ùå UMD Global Variable',
          false,
          'RembgWeb global object not found'
        );
      }
    </script>

    <script>
      // Test 2: Check UMD build functionality
      if (typeof RembgWeb !== 'undefined' && RembgWeb.remove) {
        addResult(
          '‚úÖ UMD Build Functions',
          true,
          'UMD build loaded successfully. Available functions: remove, newSession, and others.'
        );
      } else {
        addResult(
          '‚ùå UMD Build Functions',
          false,
          'UMD build functions not accessible'
        );
      }

      // Test 3: Check ONNX Runtime
      if (typeof ort !== 'undefined') {
        addResult('‚úÖ ONNX Runtime', true, 'ONNX Runtime loaded successfully');
      } else {
        addResult('‚ùå ONNX Runtime', false, 'ONNX Runtime not loaded');
      }
    </script>

    <script type="module">
      // Test 4: ES Module build
      try {
        const { remove, newSession } = await import('./dist/index.js');
        addResult(
          '‚úÖ ES Module Build',
          true,
          'ES Module build loaded successfully. Functions available: remove, newSession'
        );
      } catch (error) {
        addResult(
          '‚ùå ES Module Build',
          false,
          `ES Module build failed: ${error.message}`
        );
      }
    </script>

    <div class="test-section info">
      <h3>üìã Build Information</h3>
      <p><strong>ES Module:</strong> <code>./dist/index.js</code> (160KB)</p>
      <p>
        <strong>UMD Build:</strong> <code>./dist/index.umd.js</code> (176KB)
      </p>
      <p>
        <strong>Minified UMD:</strong>
        <code>./dist/index.umd.min.js</code> (44KB)
      </p>
      <p>
        <strong>TypeScript Definitions:</strong> <code>./dist/index.d.ts</code>
      </p>
    </div>

    <div class="test-section info">
      <h3>üìñ Usage Examples</h3>
      <h4>ES Module (for bundlers):</h4>
      <pre><code>import { remove } from '@bunnio/rembg-web';
const result = await remove(file);</code></pre>

      <h4>UMD Global (for script tags):</h4>
      <pre><code>&lt;script src="https://unpkg.com/onnxruntime-web@latest/dist/ort.min.js"&gt;&lt;/script&gt;
&lt;script src="https://unpkg.com/@bunnio/rembg-web@latest/dist/index.umd.js"&gt;&lt;/script&gt;
&lt;script&gt;
  const { remove } = RembgWeb;
  const result = await remove(file);
&lt;/script&gt;</code></pre>
    </div>
  </body>
</html>
